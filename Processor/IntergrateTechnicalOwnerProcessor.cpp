#include "IntergrateTechnicalOwnerProcessor.h"
#include "../Controller/PhysicalServerNotificationController.h"

CIntergrateTechnicalOwnerProcessor::CIntergrateTechnicalOwnerProcessor(const string& strFileName)
:CProcessor(strFileName)
{
	m_pNotificationController = new CPhysicalServerNotificationController();
}

CIntergrateTechnicalOwnerProcessor::~CIntergrateTechnicalOwnerProcessor(void)
{
	if (NULL != m_pNotificationController)
	{
		delete m_pNotificationController;
	}
}

bool CIntergrateTechnicalOwnerProcessor::Connect()
{
	RegisterController(m_pNotificationController);
	CProcessor::Connect();
}

void CIntergrateTechnicalOwnerProcessor::Proceed()
{
	if (!Connect())
	{
		return;
	}
	BSONObj boServerRecord;
	auto_ptr<DBClientCursor> ptrResultCursor = auto_ptr<DBClientCursor>();
	Query queryServer = QUERY("code" << BSON("$in" << BSON_ARRAY("DFJWG1S" << "SGH742ATK2" << "SGH940XNAF" << "CN7807007S" << "BZDW51602111" << "794852S" << "SGH743B5JY" << "CN77180073" << "SGH743B5S8" << "SGH009XC6L" << "99A6312" << "CN7729018M" << "SGH940XN9L" << "CN772902A2" << "SGH742ATK0" << "99A0487" << "CN771102AK" << "CN771700XD" << "99GHH28" << "CN771100YT" << "CN771102CG" << "CN7718008G" << "SGH743B5FE" << "FYXS42S" << "99A0491" << "4SZ2M1S" << "CN774301JH" << "99A6306" << "6WXS42S" << "SGH002XKVF" << "99A6260" << "SGH002XKSP" << "SGH002XKVJ" << "CN7729028F" << "99A0464" << "SGH002XKV7" << "99A0624" << "CN77110447" << "99CTLF1" << "CN774301KK" << "CN7718008Y" << "CN7807006Z" << "SGH940XMCB" << "CN78070079" << "99A0696" << "99A6238" << "4FJWG1S" << "99A0503" << "5TVR32S" << "99A6257" << "CN7718008X" << "CN7718008L" << "SGH940XN8T" << "CN774301JV" << "SGH940XN9D" << "CN771100Y3" << "BHLXG1S" << "CN7807006N" << "99A6276" << "CN771102B7" << "G84852S" << "2SRSD1S" << "BZDW51602151" << "CN7711044S" << "SGH940XMDB" << "99A0633" << "SGH002XKT3" << "534852S" << "99GRD63" << "DGJWG1S" << "SGH743B5SK" << "99A6338" << "CN7807007Y" << "BGJWG1S" << "83NN32S" << "CN780701AB" << "99A6280" << "SGH743B5RR" << "85NN32S" << "824852S" << "4VZ3G1S" << "2WCWG1S" << "99A6353" << "99A0719" << "G94852S" << "SGH940XMC1" << "B34852S" << "CN774301JZ" << "SGH940XMC5" << "814852S" << "CBXR42S" << "CN780701WB" << "CN7718007T" << "CN780701F3" << "99A0727" << "SGH940XMD7" << "SGH940XN85" << "SGH009X682" << "CN7718008B" << "CN780701CC" << "SGH009X6M5" << "CN780701VK" << "99A0603" << "CN7711044N" << "SGH940XMCF" << "CN774301JP" << "SGH9264C0N" << "99A6318" << "SGH940XN8W" << "99A6390" << "SGH940XMD3" << "CN780800P4" << "G34852S" << "SGH940XN8D" << "CN7718007M" << "CN771102AZ" << "CN7807005S" << "CN780701AE" << "9WXS42S" << "99A6279" << "CN774301HU" << "CN774301K8" << "CN772902AE" << "CN7807006L" << "SGH743B5FY" << "CN78070063" << "CN774301HW" << "CN7718007S" << "SGH743B5FN" << "3VRSD1S" << "CN774301KS" << "CN780701DD" << "SGH002XKVT" << "4T54G1S" << "BZDW51602138" << "SGH940XN9T" << "CN7711043X" << "BZDW51602179" << "99A0677" << "SGH743B5FD" << "99A0672" << "99A0421" << "SGH940XNA7" << "99A6329" << "C5NN32S" << "424852S" << "HB4852S" << "2MKVF1S" << "SGH940XMD1" << "2HBVF1S" << "C94852S" << "99A0419" << "75NN32S" << "CN7711044D" << "DGLXG1S" << "SGH743B5SA" << "CN7729029G" << "BXXS42S" << "SGH009X68C" << "CN771102BA" << "SGH743B5S2" << "8MKVF1S" << "CN771102BE" << "594852S" << "SGH743B5S1" << "CN771102AM" << "CN772902B5" << "CN771602FM" << "SGH743B5T1" << "SGH940XN8Y" << "FVVR32S" << "SGH93361W9" << "99A6285" << "SGH009X6MB" << "CN774301HK" << "JVCWG1S" << "99A0434" << "99A6247" << "99H1162" << "CN7729029C" << "CVVR32S" << "CN774301K3" << "CN7711004X" << "99A0513" << "CN771102B8" << "CN771102C3" << "CN772902AL" << "CN774301J7" << "SGH743B5SB" << "99GHH14" << "CN774301JK" << "FTVR32S" << "SGH940XMCD" << "324852S" << "CN771100YR" << "99A6253" << "CN7807007E" << "CN771100YD" << "CN780701AC" << "99A6395" << "99A0492" << "99A0427" << "SGH002XKTF" << "CN771102C1" << "CN771102AV" << "99A0701" << "SGH002XKTY" << "CN771102BF" << "CN7711044A" << "CN77180090" << "SGH9264C04" << "CN780800P5" << "CN7711043Z" << "SGH902YRV1" << "BGLXG1S" << "SGH743B5JW" << "CN7807005T" << "99A6391" << "99A0593" << "4R4RJ1S" << "CN772902AR" << "SGH940XN8F" << "99A0648" << "DR6S32S" << "CN780701W3" << "99A6355" << "99GPN74" << "SGH743B5RV" << "99GHG81" << "CN7729028D" << "CN7711044V" << "99A0730" << "2TVR32S" << "CN771102CF" << "99GHH26" << "CN7729029H" << "294852S" << "2CXR42S" << "4VVR32S" << "SGH940XNA9" << "99A0478" << "99A6381" << "CN7807007V" << "CN771100Y4" << "1TVR32S" << "CN774301K2" << "CN780701NT" << "CN7807007W" << "BZDW5160229B" << "99A0739" << "CN780701C6" << "CN7729028Y" << "8B4852S" << "CN780800P1" << "99A6343" << "CN772902AV" << "CN771102B1" << "CN7711044U" << "SGH743B5JN" << "SGH743B5S4" << "SGH940XN8L" << "SGH940XNAN" << "SGH940XMDN" << "CMDL32S" << "CN77180089" << "SGH940XNAD" << "CN7711043P" << "99A6314" << "CN7718006Y" << "724852S" << "CN772902AF" << "CN7807005P" << "SGH940XN9N" << "SGH743B5FM" << "99CTLE7" << "5R6S32S" << "CN771102BP" << "SGH743B5JR" << "CN771102CH" << "99A6245" << "99A0470" << "CN7807007N" << "1SZ2M1S" << "5HLXG1S" << "99A0655" << "99A0630" << "CN774301K4" << "8TVR32S" << "CN771102BH" << "SGH93361VY" << "CN774301JS" << "9FJWG1S" << "3SZ2M1S" << "CN774301KA" << "99G9953" << "CN774301JW" << "HVXS42S" << "99A0615" << "3QF542S" << "SGH002XKTT" << "D94852S" << "99A0621" << "SGH009XC6F" << "7R6S32S" << "99A0595" << "CN7807007A" << "CN7807005X" << "SGH743B5FC" << "CN7807006W" << "SGH93361VT" << "SGH742ATJL" << "CN77110442" << "J4NN32S" << "99A6275" << "SGH742ATJV" << "SGH742ATJE" << "SGH940XN81" << "CGJWG1S" << "1WCWG1S" << "CN780800S6" << "SGH743B5SF" << "CN7711043S" << "93NN32S" << "CN780701WW" << "CN774301HV" << "CN780701EB" << "G4NN32S" << "DHBVF1S" << "99A6246" << "SGH940XMCR" << "CN774301HX" << "CN7807005Z" << "99A0620" << "CN774301HS" << "SGH009XC6J" << "99A6358" << "CN7807007P" << "CN770901NM" << "SGH940XMDY" << "CN771102C9" << "CTVR32S" << "CN780701AD" << "JMKVF1S" << "SGH940XN9B" << "CN774301KG" << "99A0455" << "BVVR32S" << "SGH009XC6Y" << "SGH940XMDL" << "99A0511" << "6B1RJ1S" << "99A0717" << "SGH940XN9F" << "GVVR32S" << "CN77110441" << "7WXS42S" << "SGH940XN99" << "CN7718007E" << "7YXS42S" << "CN774301KH" << "SGH743B5JV" << "99H1172" << "99A6327" << "BR54G1S" << "99GCH07" << "7GJWG1S" << "CN780701MT" << "SGH940XMBW" << "SGH9264BYS" << "CN7718007N" << "BZDW5160230B" << "SGH022X7R6" << "CN772902TM" << "99A0450" << "99A0651" << "GBXR42S" << "CN77180099" << "99A0737" << "4Q4RJ1S" << "99A6387" << "CN7729028J" << "CN7718007B" << "CN780701FC" << "CN780701WU" << "FBXR42S" << "SGH002XKV1" << "9XXS42S" << "CN774301HE" << "SGH002XKTR" << "99A6256" << "99A0657" << "CN780701EP" << "CN7807002G" << "CN7807005C" << "CN7711043N" << "CN771100YN" << "99A0731" << "JVVR32S" << "99A0665" << "CN77180075" << "CN7711044M" << "CN7718007K" << "99A6297" << "CN774301KP" << "CN774301JX" << "99A0461" << "CN7718006M" << "CN78070064" << "99A6316" << "99A6332" << "HMKVF1S" << "9YXS42S" << "99H1171" << "3S54G1S" << "CN7718007V" << "99A0456" << "HVCWG1S" << "F4NN32S" << "CN7711043R" << "SGH009X68A" << "99A0609" << "CN7807007M" << "CN78070055" << "SGH009X6M9" << "HGLXG1S" << "BZDW51602053" << "CN7807002F" << "CN7807007B" << "99A6392" << "CN78070078" << "CN77290291" << "CN78070077" << "99A0429" << "99A0466" << "CN7729028P" << "SGH743B5S0" << "CN771102BB" << "G24852S" << "CN7729028B" << "838852S" << "CN780701EJ" << "99A0608" << "J1Y3G1S" << "CN78070072" << "CN7718007U" << "8HXD32S" << "99A0605" << "SGH940XNAW" << "CN780701X0" << "CN77110114" << "99A0474" << "SGH009X684" << "CN77290296" << "194852S" << "99A0646" << "CN780701WR" << "CN77170325" << "SGH009X6V7" << "SGH9111AV4" << "CN77180092" << "JQ6S32S" << "CN77290297" << "CN774301KB" << "SGH009XC6D" << "3WXS42S" << "CN780701EA" << "7TJ3M1S" << "6JMXG1S" << "99A0423" << "SGH743B5SL" << "SGH940XN7Y" << "CN7807018P" << "SGH742ATJK" << "SGH743B5S3" << "CN7807006U" << "SGH940XMDJ" << "SGH940XN8B" << "CN771102BL" << "CN780701EM" << "SGH742ATJM" << "99A0723" << "CN780800PP" << "99A0666" << "99A6288" << "GGLXG1S" << "CN7729029B" << "CN771102B5" << "B14852S" << "5HBVF1S" << "CN7711044L" << "SGH742ATJD" << "CN7807006Y" << "99A0718" << "99A0712" << "99A0501" << "CN7711011X" << "SGH002XKTD" << "CN780701W2" << "CN780701EK" << "SGH743B5RW" << "CN7807007F" << "334852S" << "CN780701FE" << "SGH940XNA1" << "CN774301KE" << "CN77180082" << "CN774301K1" << "CN7711044F" << "SGH9264C08" << "CN771100ZS" << "CN7718008R" << "SGH002XKTN" << "99GHG82" << "SGH940XMD5" << "CN7729029R" << "99A0417" << "CN771100YY" << "3HBVF1S" << "CN7807007D" << "SGH009X6V9" << "CN772902AB" << "CN770901NP" << "SGH009XC6W" << "99A0733" << "99A0689" << "CN7711044T" << "99A0598" << "1CXR42S" << "CN774301HN" << "SGH940XNB5" << "CN7718009E" << "99A0425" << "CN780800PJ" << "SGH743B5FK" << "CN771102BS" << "CN7807005U" << "6B4852S" << "1QF542S" << "99A0708" << "HVVR32S" << "4B4852S" << "57NRJ1S" << "5VVR32S" << "99A6370" << "99A0669" << "99A0659" << "GVCWG1S" << "CYMN32S" << "CN7711044R" << "SGH93361W3" << "CN771102CC" << "CN7807005G" << "99A0680" << "99A0618" << "JC64G1S" << "2C4852S" << "SGH743B5SJ" << "CN780800PM" << "CN780701C3" << "JVXS42S" << "1MRSD1S" << "SGH743B5FX" << "99GCG99" << "SGH002XKT1" << "CYXS42S" << "99A0636" << "SGH93361W7" << "SGH002XKV9" << "99A6311" << "99A0660" << "1R6S32S" << "99A0662" << "SGH743B5SE" << "99A0694" << "CN774301J4" << "2D64G1S" << "CN7711043T" << "99A0616" << "SGH940XNB1" << "HSVR32S" << "99A6249" << "CN78070074" << "SGH93361WB" << "7JMXG1S" << "CN78070070" << "DYXS42S" << "99A0713" << "SGH940XN9W" << "CN7807007L" << "3B4852S" << "7FJWG1S" << "DB4852S" << "99A0725" << "CN780701W8" << "SGH742ATK1" << "CN771102B9" << "9VRSD1S" << "99A0728" << "2RZ3G1S" << "7R54G1S" << "CN77180085" << "CN7807006V" << "CN7807005B" << "CN7718008H" << "CN7729028U" << "SGH002XKV5" << "99GHH30" << "CN774301JB" << "CN771100ZC" << "CN772902A0" << "SGH9264BYV" << "CN77180087" << "99A0446" << "CN78070081" << "CN771100YL" << "CN780800P2" << "CN7711011K" << "CN780701F4" << "CN7718007J" << "99A0678" << "B5NN32S" << "CN7729029L" << "CN7711044E" << "1RZ3G1S" << "99A0471" << "99GCG04" << "CN7807007T" << "CN780800RH" << "99A0627" << "CN780701E5" << "CN7807006A" << "CN7729028Z" << "99A0634" << "SGH742ATJW" << "SGH743B5FV" << "99GRL88" << "BB4852S" << "SGH009XC6R" << "3R6S32S" << "CN774301JJ" << "SGH940XMDT" << "8YXS42S" << "99GRE76" << "GYXS42S" << "CN774301HJ" << "SGH940XMDR" << "FB4852S" << "1B4852S" << "614852S" << "CR6S32S" << "CN780701DF" << "CN771102BU" << "99GRD73" << "99A6354" << "CN774301K5" << "CN780701VS" << "924852S" << "CXXS42S" << "CN77180074" << "SGH940XNAR" << "CN780701DY" << "99A6298" << "SGH743B5S7" << "4TVR32S" << "CN7718007G" << "CN7807007G" << "B3NN32S" << "CN7711011E" << "99A0729" << "SGH002XKV3" << "99A6281" << "99A6304" << "SGH743B5JT" << "6YXS42S" << "CN78070075" << "SGH742ATJT" << "8SRSD1S" << "9MRSD1S" << "99A6295" << "BMDL32S" << "CN7711011N" << "99A6271" << "CN7729029U" << "99A0619" << "CN780701DW" << "CN7807018N" << "SGH940XMC9" << "SGH743B5ST" << "D38852S" << "CN77290289" << "99A6342" << "SGH742ATJJ" << "4D64G1S" << "CN774301J2" << "CN780800P6" << "CN780701F5" << "CN7807006M" << "3HLXG1S" << "99R4394" << "99A0688" << "SGH9264BYP" << "CN77180091" << "JDJWG1S" << "99A6382" << "FQ4RJ1S" << "8R6S32S" << "CN780701EL" << "CN770900DU" << "SGH9264C0A" << "CN7807006X" << "CN7729029Z" << "99A0674" << "99A0699" << "CN780701NU" << "99A6345" << "SGH940XNAT" << "CN7711043M" << "SGH743B5FJ" << "99R4393" << "CN771102AJ" << "H4NN32S" << "99A0512" << "CN780800P7" << "CN774301K6" << "C34852S" << "99A6357" << "F24852S" << "D14852S" << "CN780701FT" << "CN780701DV" << "CN7718006S" << "CN7807006R" << "CN78070067" << "CN77180098" << "CN771100XM" << "CN78070057" << "99A6331" << "BZDW51602198" << "7VX3G1S" << "BYXS42S" << "CN7807007C" << "99A6393" << "CN78070071" << "714852S" << "CN780701WV" << "HYXS42S" << "99A6348" << "CN780701MZ" << "99A0426" << "CN772902A9" << "SGH940XNAL" << "SGH940XN97" << "3D64G1S" << "434852S" << "SGH009X686" << "HQZ3G1S" << "CN780701FG" << "99A0454" << "SGH002XKVY" << "F34852S" << "GT54G1S" << "CN780701X2" << "1WXS42S" << "DBXR42S" << "CN770901A5" << "CN780701EN" << "SGH940XMDW" << "CN774301JL" << "SGH743B5RY" << "99A6363" << "99A0440" << "99A0663" << "99A0647" << "99A0486" << "CN780701ET" << "CN774301HY" << "99A0467" << "D24852S" << "CN771100YZ" << "CN774301K9" << "SGH940XMC3" << "BT54G1S" << "SGH93361VW" << "CN770901P0" << "CN771100Y5" << "BZDW51602033" << "CN77290299" << "BZDW51602295" << "8M54G1S" << "CN774301J8" << "CN780701DB" << "J94852S" << "J84852S" << "99A0607" << "CN774301HG" << "SGH743B5SM" << "CN780701WT" << "SGH940XMC7" << "99A6396" << "99A6328" << "7HXD32S" << "8TJ3M1S" << "99A0488" << "SGH743B5FS" << "HBXR42S" << "CN771100YC" << "2R6S32S" << "SGH009X6M7" << "CN7807006B" << "SGH002XKW3" << "SGH940XNB3" << "99A0447" << "CN7718007Y" << "CN7807006D" << "FQ6S32S" << "99A0452" << "J24852S" << "99A6300" << "99A6376" << "CN772902AD" << "CN774301J3" << "SGH940XN8R" << "CN780701DP" << "99A0714" << "CN7718008K" << "99GPN61" << "CN7718008P" << "CN780701F8" << "SGH009XC6T" << "G14852S" << "SGH002XKVN" << "DTVR32S" << "CN771102BD" << "CN77290293" << "SGH940XNA5" << "CN774301KJ" << "99GRE42" << "JRZ2M1S" << "CN774301J9" << "D4NN32S" << "9TVR32S" << "DVVR32S" << "99A6317" << "CN774301JU" << "SGH940XN95" << "CN772902AJ" << "SGH742ATJR" << "99GPN86" << "CN7718008J" << "CN780800RK" << "99A0457" << "CN780701FF" << "SGH009X6M3" << "CN780701WF" << "CN772902A7" << "99A6356" << "CN780701A6" << "99GPN82" << "99H1159" << "99A0463" << "99A0599" << "SGH940XMCY" << "CN771102CA" << "CN7718007W" << "99A0436" << "CN780701EC" << "224852S" << "CN7807005R" << "CN774301J6" << "CN7718008Z" << "JQZ3G1S" << "D3NN32S" << "H94852S" << "CN774301HL" << "CN77180094" << "CN7711044C" << "99A0600" << "9B4852S" << "99A6325" << "99A0445" << "99A6365" << "CN78070073" << "CN7807006H" << "FPKVF1S" << "CN7807006K" << "99A0422" << "SGH009XC6N" << "CN774301JG" << "SGH940XMD9" << "BZDW51050428" << "99GHH22" << "3FJWG1S" << "9TJ3M1S" << "56WFS1S" << "CN774301J0" << "CN7717032B" << "99H1169" << "CN774301KN" << "994852S" << "99CTMM3" << "CN772902B6" << "99A0735" << "46WSF1S" << "SGH002XKTL" << "71Z3G1S" << "99A0637" << "99A0614" << "SGH940XNA3" << "9VVR32S" << "5R54G1S" << "CN772902A1" << "CN772902B7" << "894852S" << "CN774301JD" << "99A0415" << "CN780701CG" << "99A0671" << "CN780701A3" << "CN774301HH" << "CN7807006J" << "SGH742ATJP" << "99GPN81" << "CN771102AW" << "CN7807005N" << "CN771102B6" << "99A0506" << "99A0507" << "SGH002XKVW" << "CN7807005K" << "CN7807002K" << "99A0504" << "99A6282" << "CN7807005W" << "C24852S" << "CN771102BM" << "4R6S32S" << "SGH940XNAJ" << "FXXS42S" << "CN7718007F" << "BZDW51602175" << "SGH940XMDD" << "C3NN32S" << "SGH940XMCN" << "CN774301J1" << "99A6270" << "FT54G1S" << "99A6250" << "BZDW51602299" << "SGH743B5FT" << "CN771102AN" << "1C4852S" << "CN7729028H" << "3RZ3G1S" << "2QF542S" << "CN774301K7" << "99A0416" << "JSVR32S" << "BPGWF1S" << "99GRF08" << "99A0626" << "CN7718007C" << "SGH9111AVB" << "99A6371" << "SGH743B5T7" << "SGH002XKVB" << "GB4852S" << "99A0424" << "1MBVF1S" << "CN7729029K" << "G91RJ1S" << "CN771100Z1" << "99A6368" << "634852S" << "SGH940XN93" << "BZDW51602109" << "BZDW51602057" << "F14852S" << "BZDW51602144" << "SGH940XMDF" << "99A0667" << "99A0480" << "SGH743B5SC" << "SGH940XN89" << "SGH940XNAY" << "99A0734" << "99A6398" << "99A0692" << "89JK32S" << "CN7729028K" << "CN78070061" << "CN7729028R" << "99A6274" << "99A0611" << "CN780701W1" << "CSZVD1S" << "CN77290295" << "2WXS42S" << "99CTLE9" << "99A0720" << "99A0695")));
	BSONObj boPartnerInfo = BSON("noti_status" << 0 << "DC" << 0 << "SNS" << 1 << "action_type" << 2);
	m_pNotificationController->Find("server", ptrResultCursor, queryServer);
	while (ptrResultCursor->more())
	{
		boServerRecord = ptrResultCursor->nextSafe();
		boServerRecord = CMongodbModel::MergeBSONObj(&boServerRecord, &boPartnerInfo);
		cout << "boServerRecord:" << boServerRecord << endl << endl;
		m_pNotificationController->Insert(boServerRecord);
	}
}